<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adaptive Refinments callbacks &mdash; PINA 0.1.1.post2407 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="LpLoss" href="../loss/loss_interface.html" />
    <link rel="prev" title="Optimizer callbacks" href="optimizer_callbacks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/pina_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.1.post2407
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Package Documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../_code.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../_code.html#pina-features">PINA Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#solvers">Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#layers">Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#adaptive-activation-functions">Adaptive Activation Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#equations-and-operators">Equations and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#problem">Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#geometries">Geometries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#geometry-set-operations">Geometry set operations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../_code.html#callbacks">Callbacks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="processing_callbacks.html">Metric tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="optimizer_callbacks.html">Optimizer callbacks</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Adaptive Refinments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#metrics-and-losses">Metrics and Losses</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_tutorial.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Community:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../_team.html">Team &amp; Fundings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_LICENSE.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_cite.html">Cite PINA</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PINA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../_code.html">Code Documentation</a></li>
      <li class="breadcrumb-item active">Adaptive Refinments callbacks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/_rst/callbacks/adaptive_refinment_callbacks.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="adaptive-refinments-callbacks">
<h1>Adaptive Refinments callbacks<a class="headerlink" href="#adaptive-refinments-callbacks" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pina.callbacks.adaptive_refinment_callbacks.R3Refinement">
<em class="property">class </em><code class="sig-name descname">R3Refinement</code><span class="sig-paren">(</span><em class="sig-param">sample_every</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/callbacks/adaptive_refinment_callbacks.html#R3Refinement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.callbacks.adaptive_refinment_callbacks.R3Refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pytorch_lightning.callbacks.callback.Callback</span></code></p>
<p>PINA Implementation of an R3 Refinement Callback.</p>
<p>This callback implements the R3 (Retain-Resample-Release) routine for
sampling new points based on adaptive search.
The algorithm incrementally accumulates collocation points in regions
of high PDE residuals, and releases those
with low residuals. Points are sampled uniformly in all regions
where sampling is needed.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Original Reference: Daw, Arka, et al. <em>Mitigating Propagation
Failures in Physics-informed Neural Networks
using Retain-Resample-Release (R3) Sampling. (2023)</em>.
DOI: <a class="reference external" href="https://doi.org/10.48550/arXiv.2207.02338">10.48550/arXiv.2207.02338</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sample_every</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – Frequency for sampling.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><strong>ValueError</strong></a> – If <cite>sample_every</cite> is not an integer.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r3_callback</span> <span class="o">=</span> <span class="n">R3Refinement</span><span class="p">(</span><span class="n">sample_every</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="pina.callbacks.adaptive_refinment_callbacks.R3Refinement.on_train_start">
<code class="sig-name descname">on_train_start</code><span class="sig-paren">(</span><em class="sig-param">trainer</em>, <em class="sig-param">_</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/callbacks/adaptive_refinment_callbacks.html#R3Refinement.on_train_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.callbacks.adaptive_refinment_callbacks.R3Refinement.on_train_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback function called at the start of training.</p>
<p>This method extracts the locations for sampling from the problem
conditions and calculates the total population.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<em>pytorch_lightning.Trainer</em>) – The trainer object managing the training process.</p></li>
<li><p><strong>_</strong> – Placeholder argument (not used).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)">None</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pina.callbacks.adaptive_refinment_callbacks.R3Refinement.on_train_epoch_end">
<code class="sig-name descname">on_train_epoch_end</code><span class="sig-paren">(</span><em class="sig-param">trainer</em>, <em class="sig-param">__</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/callbacks/adaptive_refinment_callbacks.html#R3Refinement.on_train_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.callbacks.adaptive_refinment_callbacks.R3Refinement.on_train_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback function called at the end of each training epoch.</p>
<p>This method triggers the R3 routine for refinement if the current
epoch is a multiple of <cite>_sample_every</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<em>pytorch_lightning.Trainer</em>) – The trainer object managing the training process.</p></li>
<li><p><strong>__</strong> – Placeholder argument (not used).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)">None</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="optimizer_callbacks.html" class="btn btn-neutral float-left" title="Optimizer callbacks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../loss/loss_interface.html" class="btn btn-neutral float-right" title="LpLoss" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024, PINA Contributors.
      <span class="lastupdated">Last updated on Jul 01, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>