
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Periodic Boundary Condition Embedding &#8212; pina-mathlab 0.2.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=938c9ccc"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_rst/model/block/pbc_embedding';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Fourier Feature Embedding" href="fourier_embedding.html" />
    <link rel="prev" title="Proper Orthogonal Decomposition Block" href="pod_block.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.2.0" />
    <meta name="docbuild:last-update" content="Apr 23, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
    
    <img src="../../../_static/PINA_logo.png" class="logo__image only-light" alt="pina-mathlab 0.2.0 documentation - Home"/>
    <img src="../../../_static/PINA_logo.png" class="logo__image only-dark pst-js-only" alt="pina-mathlab 0.2.0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../_code.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_tutorial.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_cite.html">
    Cite PINA
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_team.html">
    Team & Foundings
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_LICENSE.html">
    License
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mathLab/PINA" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/pina_mathlab?s=21" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="mailto:pina.mathlab@gmail.com" title="Email" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Email</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../_code.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_tutorial.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_cite.html">
    Cite PINA
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_team.html">
    Team & Foundings
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_LICENSE.html">
    License
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mathLab/PINA" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/pina_mathlab?s=21" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="mailto:pina.mathlab@gmail.com" title="Email" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Email</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../trainer.html">Trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/dataset.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/data_module.html">DataModule</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../label_tensor.html">LabelTensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graph/graph.html">Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graph/label_batch.html">LabelBatch</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../graph/graph_builder.html">GraphBuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graph/radius_graph.html">RadiusGraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graph/knn_graph.html">KNNGraph</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../condition/condition_interface.html">ConditionInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../condition/condition.html">Condition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../condition/data_condition.html">DataCondition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../condition/domain_equation_condition.html">DomainEquationCondition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../condition/input_equation_condition.html">InputEquationCondition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../condition/input_target_condition.html">InputTargetCondition</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../solver/solver_interface.html">SolverInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/single_solver_interface.html">SingleSolverInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/multi_solver_interface.html">MultiSolverInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/supervised_solver/supervised_solver_interface.html">SupervisedSolverInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/ensemble_solver/ensemble_solver_interface.html">DeepEnsembleSolverInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/physics_informed_solver/pinn_interface.html">PINNInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/physics_informed_solver/pinn.html">PINN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/physics_informed_solver/gradient_pinn.html">GradientPINN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/physics_informed_solver/causal_pinn.html">CausalPINN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/physics_informed_solver/competitive_pinn.html">CompetitivePINN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/physics_informed_solver/self_adaptive_pinn.html">SelfAdaptivePINN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/physics_informed_solver/rba_pinn.html">RBAPINN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/ensemble_solver/ensemble_pinn.html">DeepEnsemblePINN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/supervised_solver/supervised.html">SupervisedSolver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/ensemble_solver/ensemble_supervised.html">DeepEnsembleSupervisedSolver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/supervised_solver/reduced_order_model.html">ReducedOrderModelSolver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solver/garom.html">GAROM</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../feed_forward.html">FeedForward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multi_feed_forward.html">MultiFeedForward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../residual_feed_forward.html">ResidualFeedForward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spline.html">Spline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deeponet.html">DeepONet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mionet.html">MIONet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel_neural_operator.html">KernelNeuralOperator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fourier_integral_kernel.html">FourierIntegralKernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fourier_neural_operator.html">FNO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../average_neural_operator.html">AveragingNeuralOperator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../low_rank_neural_operator.html">LowRankNeuralOperator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_neural_operator.html">GraphNeuralOperator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_neural_operator_integral_kernel.html">GraphNeuralKernel</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="residual.html">Residual Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="enhanced_linear.html">EnhancedLinear Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectral.html">Spectral Convolution Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourier_block.html">Fourier Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="average_neural_operator_block.html">Averaging Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="low_rank_block.html">Low Rank Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="gno_block.html">Graph Neural Operator Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="convolution_interface.html">Continuous Convolution Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="convolution.html">Continuous Convolution Block</a></li>
<li class="toctree-l1"><a class="reference internal" href="orthogonal.html">Orthogonal Block</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pod_block.html">Proper Orthogonal Decomposition</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Periodic Boundary Condition Embedding</a></li>
<li class="toctree-l1"><a class="reference internal" href="fourier_embedding.html">Fourier Feature Embedding</a></li>
<li class="toctree-l1"><a class="reference internal" href="rbf_block.html">Radial Basis Function Interpolation</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../optim/optimizer_interface.html">Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../optim/scheduler_interface.html">Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../optim/torch_optimizer.html">TorchOptimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../optim/torch_scheduler.html">TorchScheduler</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveActivationFunctionInterface.html">Adaptive Function Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveReLU.html">Adaptive ReLU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveSigmoid.html">Adaptive Sigmoid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveTanh.html">Adaptive Tanh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveSiLU.html">Adaptive SiLU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveMish.html">Adaptive Mish</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveELU.html">Adaptive ELU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveCELU.html">Adaptive CELU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveGELU.html">Adaptive GELU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveSoftmin.html">Adaptive Softmin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveSoftmax.html">Adaptive Softmax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveSIREN.html">Adaptive SIREN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../adaptive_function/AdaptiveExp.html">Adaptive Exp</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../equation/equation_interface.html">EquationInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../equation/equation.html">Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../equation/system_equation.html">SystemEquation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../equation/equation_factory.html">Equation Factory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operator.html">Differential Operators</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../problem/abstract_problem.html">AbstractProblem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem/inverse_problem.html">InverseProblem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem/parametric_problem.html">ParametricProblem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem/spatial_problem.html">SpatialProblem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem/time_dependent_problem.html">TimeDependentProblem</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../problem/zoo/advection.html">AdvectionProblem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem/zoo/allen_cahn.html">AllenCahnProblem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem/zoo/diffusion_reaction.html">DiffusionReactionProblem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem/zoo/helmholtz.html">HelmholtzProblem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem/zoo/inverse_poisson_2d_square.html">InversePoisson2DSquareProblem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem/zoo/poisson_2d_square.html">Poisson2DSquareProblem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../problem/zoo/supervised_problem.html">SupervisedProblem</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../domain/domain.html">Domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../domain/cartesian.html">CartesianDomain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../domain/ellipsoid.html">EllipsoidDomain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../domain/simplex.html">SimplexDomain</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../domain/operation_interface.html">OperationInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../domain/union_domain.html">Union</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../domain/intersection_domain.html">Intersection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../domain/difference_domain.html">Difference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../domain/exclusion_domain.html">Exclusion</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../callback/processing_callback.html">Processing callback</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../callback/optimizer_callback.html">Optimizer callback</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../callback/adaptive_refinment_callback.html">Refinment callback</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../callback/linear_weight_update_callback.html">Weighting callback</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../loss/loss_interface.html">LossInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../loss/lploss.html">LpLoss</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../loss/powerloss.html">PowerLoss</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../loss/weighting_interface.html">WeightingInterface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../loss/scalar_weighting.html">ScalarWeighting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../loss/ntk_weighting.html">NeuralTangentKernelWeighting</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../_code.html" class="nav-link">Code Documentation</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Periodic Boundary Condition Embedding</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="periodic-boundary-condition-embedding">
<h1>Periodic Boundary Condition Embedding<a class="headerlink" href="#periodic-boundary-condition-embedding" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pina.model.block.embedding.PeriodicBoundaryEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PeriodicBoundaryEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dimension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periods</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dimension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pina/model/block/embedding.html#PeriodicBoundaryEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pina.model.block.embedding.PeriodicBoundaryEmbedding" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Enforcing hard-constrained periodic boundary conditions by embedding the
input.</p>
<p>A function <span class="math notranslate nohighlight">\(u:\mathbb{R}^{\rm{in}} \rightarrow\mathbb{R}^{\rm{out}}\)</span>
is periodic with respect to the spatial coordinates <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>
with period <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> if:</p>
<div class="math notranslate nohighlight">
\[u(\mathbf{x})  = u(\mathbf{x} + n \mathbf{L})\;\;
\forall n\in\mathbb{N}.\]</div>
<p>The <a class="reference internal" href="#pina.model.block.embedding.PeriodicBoundaryEmbedding" title="pina.model.block.embedding.PeriodicBoundaryEmbedding"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeriodicBoundaryEmbedding</span></code></a> augments the input as follows:</p>
<div class="math notranslate nohighlight">
\[\mathbf{x} \rightarrow \tilde{\mathbf{x}} = \left[1,
\cos\left(\frac{2\pi}{L_1} x_1 \right),
\sin\left(\frac{2\pi}{L_1}x_1\right), \cdots,
\cos\left(\frac{2\pi}{L_{\rm{in}}}x_{\rm{in}}\right),
\sin\left(\frac{2\pi}{L_{\rm{in}}}x_{\rm{in}}\right)\right],\]</div>
<p>where <span class="math notranslate nohighlight">\(\text{dim}(\tilde{\mathbf{x}}) = 3\text{dim}(\mathbf{x})\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><strong>Original reference</strong>:</dt><dd><ol class="arabic simple">
<li><p>Dong, Suchuan, and Naxian Ni (2021).
<em>A method for representing periodic functions and enforcing
exactly periodic boundary conditions with deep neural networks</em>.
Journal of Computational Physics 435, 110242.
DOI: <a class="reference external" href="https://doi.org/10.1016/j.jcp.2021.110242">10.1016/j.jcp.2021.110242.</a></p></li>
<li><p>Wang, S., Sankaran, S., Wang, H., &amp; Perdikaris, P. (2023).
<em>An expert’s guide to training physics-informed neural
networks</em>.
DOI: <a class="reference external" href="https://arxiv.org/abs/2308.08468">arXiv preprint arXiv:2308.0846.</a></p></li>
</ol>
</dd>
</dl>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The embedding is a truncated fourier expansion, and enforces periodic
boundary conditions only for the function, and not for its derivatives.
Enforcement of the approximate periodicity in the derivatives can be
performed. Extensive tests have shown (see referenced papers) that this
implementation can correctly enforce the periodic boundary conditions on
the derivatives up to the order <span class="math notranslate nohighlight">\(\sim 2,3\)</span>. This is not guaranteed
for orders <span class="math notranslate nohighlight">\(&gt;3\)</span>. The PINA module is tested only for periodic
boundary conditions on the function itself.</p>
</div>
<p>Initialization of the <a class="reference internal" href="#pina.model.block.embedding.PeriodicBoundaryEmbedding" title="pina.model.block.embedding.PeriodicBoundaryEmbedding"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeriodicBoundaryEmbedding</span></code></a> block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dimension</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The dimension of the input tensor.</p></li>
<li><p><strong>periods</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – The periodicity with respect to each dimension for the
input data. If <code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">int</span></code> is passed, the period is assumed
to be constant over all the dimensions of the data. If a <code class="docutils literal notranslate"><span class="pre">dict</span></code> is
passed the <code class="docutils literal notranslate"><span class="pre">dict.values</span></code> represent periods, while the <code class="docutils literal notranslate"><span class="pre">dict.keys</span></code>
represent the dimension where the periodicity is enforced.
The <code class="docutils literal notranslate"><span class="pre">dict.keys</span></code> can either be <code class="docutils literal notranslate"><span class="pre">int</span></code> if working with
<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>, or <code class="docutils literal notranslate"><span class="pre">str</span></code> if working with
<a class="reference internal" href="../../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><code class="xref py py-class docutils literal notranslate"><span class="pre">pina.label_tensor.LabelTensor</span></code></a>.</p></li>
<li><p><strong>output_dimension</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The dimension of the output after the
fourier embedding. If not <code class="docutils literal notranslate"><span class="pre">None</span></code>, a <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code></a> layer
is applied to the fourier embedding output to match the desired
dimensionality. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If the periods dict is not consistent.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pina.model.block.embedding.PeriodicBoundaryEmbedding.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pina/model/block/embedding.html#PeriodicBoundaryEmbedding.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pina.model.block.embedding.PeriodicBoundaryEmbedding.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>torch.Tensor</em></a><em> | </em><a class="reference internal" href="../../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><em>LabelTensor</em></a>) – The input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Periodic embedding of the input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pina.model.block.embedding.PeriodicBoundaryEmbedding.period">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">period</span></span><a class="headerlink" href="#pina.model.block.embedding.PeriodicBoundaryEmbedding.period" title="Link to this definition">#</a></dt>
<dd><p>The period of the function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The period of the function.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pina.model.block.embedding.PeriodicBoundaryEmbedding"><code class="docutils literal notranslate"><span class="pre">PeriodicBoundaryEmbedding</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pina.model.block.embedding.PeriodicBoundaryEmbedding.forward"><code class="docutils literal notranslate"><span class="pre">PeriodicBoundaryEmbedding.forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pina.model.block.embedding.PeriodicBoundaryEmbedding.period"><code class="docutils literal notranslate"><span class="pre">PeriodicBoundaryEmbedding.period</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/_rst/model/block/pbc_embedding.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

<footer class="footer" style="border-top: 1px solid #ccc; padding-top: 10px">
    <div class="container">
        <div id="credits" style="width: 50%; float: left">
            <p>
                &#169; Copyright 2021-2025, <a
                    href="https://github.com/mathLab/PINA/">PINA Developers</a>.<br />
                Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and the <a
                    href="https://pydata-sphinx-theme.readthedocs.io/en/stable/">PyData Theme</a>.<br />
            </p>
        </div>
    </div>
    </div>
</footer>
  </body>
</html>