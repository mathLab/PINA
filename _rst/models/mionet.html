<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MIONet &mdash; PINA 0.1.1 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FourierIntegralKernel" href="fourier_kernel.html" />
    <link rel="prev" title="DeepONet" href="deeponet.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/pina_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Package Documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../_code.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../_code.html#pina-features">PINA Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#solvers">Solvers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../_code.html#models">Models</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="network.html">Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="base_no.html">KernelNeuralOperator</a></li>
<li class="toctree-l3"><a class="reference internal" href="fnn.html">FeedForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="multifeedforward.html">MultiFeedForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="fnn_residual.html">ResidualFeedForward</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeponet.html">DeepONet</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">MIONet</a></li>
<li class="toctree-l3"><a class="reference internal" href="fourier_kernel.html">FourierIntegralKernel</a></li>
<li class="toctree-l3"><a class="reference internal" href="fno.html">FNO</a></li>
<li class="toctree-l3"><a class="reference internal" href="avno.html">AveragingNeuralOperator</a></li>
<li class="toctree-l3"><a class="reference internal" href="lno.html">LowRankNeuralOperator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#layers">Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#adaptive-activation-functions">Adaptive Activation Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#equations-and-operators">Equations and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#problem">Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#geometries">Geometries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#geometry-set-operations">Geometry set operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#callbacks">Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#metrics-and-losses">Metrics and Losses</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_tutorial.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Community:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../_team.html">Team &amp; Fundings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_LICENSE.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_cite.html">Cite PINA</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PINA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../_code.html">Code Documentation</a></li>
      <li class="breadcrumb-item active">MIONet</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/_rst/models/mionet.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="mionet">
<h1>MIONet<a class="headerlink" href="#mionet" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pina.model.deeponet.MIONet">
<em class="property">class </em><code class="sig-name descname">MIONet</code><span class="sig-paren">(</span><em class="sig-param">networks</em>, <em class="sig-param">aggregator='*'</em>, <em class="sig-param">reduction='+'</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">translation=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/model/deeponet.html#MIONet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.model.deeponet.MIONet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></a></p>
<p>The PINA implementation of MIONet network.</p>
<p>MIONet is a general architecture for learning Operators defined
on the tensor product of Banach spaces. Unlike traditional machine
learning methods MIONet is designed to map entire functions to other functions.
It can be trained both with Physics Informed or Supervised learning strategies.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><strong>Original reference</strong>: Jin, Pengzhan, Shuai Meng, and Lu Lu.
<em>MIONet: Learning multiple-input operators via tensor product.</em>
SIAM Journal on Scientific Computing 44.6 (2022): A3490-A351
DOI: <a class="reference external" href="https://doi.org/10.1137/22M1477751">10.1137/22M1477751</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>networks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – The neural networks to use as
models. The <code class="docutils literal notranslate"><span class="pre">dict</span></code> takes as key a neural network, and
as value the list of indeces to extract from the input variable
in the forward pass of the neural network. If a list of <code class="docutils literal notranslate"><span class="pre">int</span></code> is passed,
the corresponding columns of the inner most entries are extracted.
If a list of <code class="docutils literal notranslate"><span class="pre">str</span></code> is passed the variables of the corresponding <a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pina.label_tensor.LabelTensor</span></code></a>
are extracted. The <code class="docutils literal notranslate"><span class="pre">torch.nn.Module</span></code> model has to take as input a
<a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pina.label_tensor.LabelTensor</span></code></a> or <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>.
Default implementation consist of different branch nets and one trunk nets.</p></li>
<li><p><strong>or Callable aggregator</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Aggregator to be used to aggregate
partial results from the modules in <cite>nets</cite>. Partial results are
aggregated component-wise. Available aggregators include
sum: <code class="docutils literal notranslate"><span class="pre">+</span></code>, product: <code class="docutils literal notranslate"><span class="pre">*</span></code>, mean: <code class="docutils literal notranslate"><span class="pre">mean</span></code>, min: <code class="docutils literal notranslate"><span class="pre">min</span></code>, max: <code class="docutils literal notranslate"><span class="pre">max</span></code>.</p></li>
<li><p><strong>or Callable reduction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Reduction to be used to reduce
the aggregated result of the modules in <cite>nets</cite> to the desired output
dimension. Available reductions include
sum: <code class="docutils literal notranslate"><span class="pre">+</span></code>, product: <code class="docutils literal notranslate"><span class="pre">*</span></code>, mean: <code class="docutils literal notranslate"><span class="pre">mean</span></code>, min: <code class="docutils literal notranslate"><span class="pre">min</span></code>, max: <code class="docutils literal notranslate"><span class="pre">max</span></code>.</p></li>
<li><p><strong>or Callable scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Scaling the final output before returning the
forward pass, default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>or Callable translation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Translating the final output before
returning the forward pass, default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In the forward pass we do not check if the input is instance of
<a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pina.label_tensor.LabelTensor</span></code></a> or <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>. A general rule is
that for a <a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pina.label_tensor.LabelTensor</span></code></a> input both list of integers and
list of strings can be passed for <code class="docutils literal notranslate"><span class="pre">input_indeces_branch_net</span></code>
and <code class="docutils literal notranslate"><span class="pre">input_indeces_trunk_net</span></code>. Differently, for a <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>
only a list of integers can be passed for <code class="docutils literal notranslate"><span class="pre">input_indeces_branch_net</span></code>
and <code class="docutils literal notranslate"><span class="pre">input_indeces_trunk_net</span></code>.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">branch_net1</span> <span class="o">=</span> <span class="n">FeedForward</span><span class="p">(</span><span class="n">input_dimensons</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output_dimensions</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">branch_net2</span> <span class="o">=</span> <span class="n">FeedForward</span><span class="p">(</span><span class="n">input_dimensons</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">output_dimensions</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trunk_net</span> <span class="o">=</span> <span class="n">FeedForward</span><span class="p">(</span><span class="n">input_dimensons</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">output_dimensions</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">networks</span> <span class="o">=</span> <span class="p">{</span><span class="n">branch_net1</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
<span class="go">                branch_net2 : [&#39;x&#39;, &#39;y&#39;],</span>
<span class="gp">... </span>            <span class="n">trunk_net</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MIONet</span><span class="p">(</span><span class="n">networks</span><span class="o">=</span><span class="n">networks</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">aggregator</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span>
<span class="go">MIONet(</span>
<span class="go">(models): ModuleList(</span>
<span class="go">    (0): FeedForward(</span>
<span class="go">    (model): Sequential(</span>
<span class="go">        (0): Linear(in_features=1, out_features=20, bias=True)</span>
<span class="go">        (1): Tanh()</span>
<span class="go">        (2): Linear(in_features=20, out_features=20, bias=True)</span>
<span class="go">        (3): Tanh()</span>
<span class="go">        (4): Linear(in_features=20, out_features=10, bias=True)</span>
<span class="go">    )</span>
<span class="go">    )</span>
<span class="go">    (1): FeedForward(</span>
<span class="go">    (model): Sequential(</span>
<span class="go">        (0): Linear(in_features=2, out_features=20, bias=True)</span>
<span class="go">        (1): Tanh()</span>
<span class="go">        (2): Linear(in_features=20, out_features=20, bias=True)</span>
<span class="go">        (3): Tanh()</span>
<span class="go">        (4): Linear(in_features=20, out_features=10, bias=True)</span>
<span class="go">    )</span>
<span class="go">    )</span>
<span class="go">    (2): FeedForward(</span>
<span class="go">    (model): Sequential(</span>
<span class="go">        (0): Linear(in_features=1, out_features=20, bias=True)</span>
<span class="go">        (1): Tanh()</span>
<span class="go">        (2): Linear(in_features=20, out_features=20, bias=True)</span>
<span class="go">        (3): Tanh()</span>
<span class="go">        (4): Linear(in_features=20, out_features=10, bias=True)</span>
<span class="go">    )</span>
<span class="go">    )</span>
<span class="go">)</span>
<span class="go">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="pina.model.deeponet.MIONet.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/model/deeponet.html#MIONet.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.model.deeponet.MIONet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>or torch.Tensor x</strong> (<a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><em>LabelTensor</em></a>) – The input tensor for the forward call.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output computed by the DeepONet model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor">LabelTensor</a> or <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.3)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pina.model.deeponet.MIONet.aggregator">
<em class="property">property </em><code class="sig-name descname">aggregator</code><a class="headerlink" href="#pina.model.deeponet.MIONet.aggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>The aggregator function.</p>
</dd></dl>

<dl class="method">
<dt id="pina.model.deeponet.MIONet.reduction">
<em class="property">property </em><code class="sig-name descname">reduction</code><a class="headerlink" href="#pina.model.deeponet.MIONet.reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>The translation factor.</p>
</dd></dl>

<dl class="method">
<dt id="pina.model.deeponet.MIONet.scale">
<em class="property">property </em><code class="sig-name descname">scale</code><a class="headerlink" href="#pina.model.deeponet.MIONet.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>The scale factor.</p>
</dd></dl>

<dl class="method">
<dt id="pina.model.deeponet.MIONet.translation">
<em class="property">property </em><code class="sig-name descname">translation</code><a class="headerlink" href="#pina.model.deeponet.MIONet.translation" title="Permalink to this definition">¶</a></dt>
<dd><p>The translation factor for MIONet.</p>
</dd></dl>

<dl class="method">
<dt id="pina.model.deeponet.MIONet.indeces_variables_extracted">
<em class="property">property </em><code class="sig-name descname">indeces_variables_extracted</code><a class="headerlink" href="#pina.model.deeponet.MIONet.indeces_variables_extracted" title="Permalink to this definition">¶</a></dt>
<dd><p>The input indeces for each model in form of list.</p>
</dd></dl>

<dl class="method">
<dt id="pina.model.deeponet.MIONet.model">
<em class="property">property </em><code class="sig-name descname">model</code><a class="headerlink" href="#pina.model.deeponet.MIONet.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The models in form of list.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="deeponet.html" class="btn btn-neutral float-left" title="DeepONet" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fourier_kernel.html" class="btn btn-neutral float-right" title="FourierIntegralKernel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024, PINA Contributors.
      <span class="lastupdated">Last updated on May 11, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>