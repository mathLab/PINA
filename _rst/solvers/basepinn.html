<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PINNInterface &mdash; PINA 0.1.1.post2407 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="PINN" href="pinn.html" />
    <link rel="prev" title="SolverInterface" href="solver_interface.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/pina_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.1.post2407
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Package Documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../_code.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../_code.html#pina-features">PINA Features</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../_code.html#solvers">Solvers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="solver_interface.html">SolverInterface</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">PINNInterface</a></li>
<li class="toctree-l3"><a class="reference internal" href="pinn.html">PINN</a></li>
<li class="toctree-l3"><a class="reference internal" href="gpinn.html">GPINN</a></li>
<li class="toctree-l3"><a class="reference internal" href="causalpinn.html">CausalPINN</a></li>
<li class="toctree-l3"><a class="reference internal" href="competitivepinn.html">CompetitivePINN</a></li>
<li class="toctree-l3"><a class="reference internal" href="sapinn.html">SAPINN</a></li>
<li class="toctree-l3"><a class="reference internal" href="rba_pinn.html">RBAPINN</a></li>
<li class="toctree-l3"><a class="reference internal" href="supervised.html">Supervised solver</a></li>
<li class="toctree-l3"><a class="reference internal" href="rom.html">ReducedOrderModelSolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="garom.html">GAROM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#layers">Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#adaptive-activation-functions">Adaptive Activation Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#equations-and-operators">Equations and Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#problem">Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#geometries">Geometries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#geometry-set-operations">Geometry set operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#callbacks">Callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_code.html#metrics-and-losses">Metrics and Losses</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_tutorial.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Community:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../_team.html">Team &amp; Fundings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_LICENSE.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../_cite.html">Cite PINA</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PINA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../_code.html">Code Documentation</a></li>
      <li class="breadcrumb-item active">PINNInterface</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/_rst/solvers/basepinn.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="pinninterface">
<h1>PINNInterface<a class="headerlink" href="#pinninterface" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="pina.solvers.pinns.basepinn.PINNInterface">
<em class="property">class </em><code class="sig-name descname">PINNInterface</code><span class="sig-paren">(</span><em class="sig-param">models</em>, <em class="sig-param">problem</em>, <em class="sig-param">optimizers</em>, <em class="sig-param">optimizers_kwargs</em>, <em class="sig-param">extra_features</em>, <em class="sig-param">loss</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/solvers/pinns/basepinn.html#PINNInterface"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.solvers.pinns.basepinn.PINNInterface" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="solver_interface.html#pina.solvers.solver.SolverInterface" title="pina.solvers.solver.SolverInterface"><code class="xref py py-class docutils literal notranslate"><span class="pre">pina.solvers.solver.SolverInterface</span></code></a></p>
<p>Base PINN solver class. This class implements the Solver Interface
for Physics Informed Neural Network solvers.</p>
<p>This class can be used to
define PINNs with multiple <code class="docutils literal notranslate"><span class="pre">optimizers</span></code>, and/or <code class="docutils literal notranslate"><span class="pre">models</span></code>.
By default it takes
an <a class="reference internal" href="../problem/abstractproblem.html#pina.problem.abstract_problem.AbstractProblem" title="pina.problem.abstract_problem.AbstractProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractProblem</span></code></a>, so it is up
to the user to choose which problem the implemented solver inheriting from
this class is suitable for.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>(</em><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.3)"><em>torch.nn.Module</em></a><em>)</em>) – Multiple torch neural network models instances.</p></li>
<li><p><strong>problem</strong> (<a class="reference internal" href="../problem/abstractproblem.html#pina.problem.abstract_problem.AbstractProblem" title="pina.problem.abstract_problem.AbstractProblem"><em>AbstractProblem</em></a>) – A problem definition instance.</p></li>
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>(</em><a class="reference external" href="https://pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.3)"><em>torch.optim.Optimizer</em></a><em>)</em>) – A list of neural network
optimizers to use.</p></li>
<li><p><strong>optimizer_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>)</em>) – A list of optimizer constructor
keyword args.</p></li>
<li><p><strong>extra_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>(</em><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.3)"><em>torch.nn.Module</em></a><em>)</em>) – The additional input
features to use as augmented input. If <code class="docutils literal notranslate"><span class="pre">None</span></code> no extra features
are passed. If it is a list of <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>,
the extra feature list is passed to all models. If it is a list
of extra features’ lists, each single list of extra feature
is passed to a model.</p></li>
<li><p><strong>loss</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.3)"><em>torch.nn.Module</em></a>) – The loss function used as minimizer,
default <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.MSELoss.html#torch.nn.MSELoss" title="(in PyTorch v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.MSELoss</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="pina.solvers.pinns.basepinn.PINNInterface.training_step">
<code class="sig-name descname">training_step</code><span class="sig-paren">(</span><em class="sig-param">batch</em>, <em class="sig-param">_</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/solvers/pinns/basepinn.html#PINNInterface.training_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.solvers.pinns.basepinn.PINNInterface.training_step" title="Permalink to this definition">¶</a></dt>
<dd><p>The Physics Informed Solver Training Step. This function takes care
of the physics informed training step, and it must not be override
if not intentionally. It handles the batching mechanism, the workload
division for the various conditions, the inverse problem clamping,
and loggers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a>) – The batch element in the dataloader.</p></li>
<li><p><strong>batch_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The batch index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The sum of the loss functions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor">LabelTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pina.solvers.pinns.basepinn.PINNInterface.loss_data">
<code class="sig-name descname">loss_data</code><span class="sig-paren">(</span><em class="sig-param">input_tensor</em>, <em class="sig-param">output_tensor</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/solvers/pinns/basepinn.html#PINNInterface.loss_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.solvers.pinns.basepinn.PINNInterface.loss_data" title="Permalink to this definition">¶</a></dt>
<dd><p>The data loss for the PINN solver. It computes the loss between
the network output against the true solution. This function
should not be override if not intentionally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_tensor</strong> (<a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><em>LabelTensor</em></a>) – The input to the neural networks.</p></li>
<li><p><strong>output_tensor</strong> (<a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><em>LabelTensor</em></a>) – The true solution to compare the
network solution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The residual loss averaged on the input coordinates</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.3)">torch.Tensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pina.solvers.pinns.basepinn.PINNInterface.loss_phys">
<em class="property">abstract </em><code class="sig-name descname">loss_phys</code><span class="sig-paren">(</span><em class="sig-param">samples</em>, <em class="sig-param">equation</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/solvers/pinns/basepinn.html#PINNInterface.loss_phys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.solvers.pinns.basepinn.PINNInterface.loss_phys" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the physics loss for the physics informed solver based on given
samples and equation. This method must be override by all inherited
classes and it is the core to define a new physics informed solver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><em>LabelTensor</em></a>) – The samples to evaluate the physics loss.</p></li>
<li><p><strong>equation</strong> (<a class="reference internal" href="../equations.html#pina.equation.equation_interface.EquationInterface" title="pina.equation.equation_interface.EquationInterface"><em>EquationInterface</em></a>) – The governing equation
representing the physics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The physics loss calculated based on given
samples and equation.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor">LabelTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pina.solvers.pinns.basepinn.PINNInterface.compute_residual">
<code class="sig-name descname">compute_residual</code><span class="sig-paren">(</span><em class="sig-param">samples</em>, <em class="sig-param">equation</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/solvers/pinns/basepinn.html#PINNInterface.compute_residual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.solvers.pinns.basepinn.PINNInterface.compute_residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the residual for Physics Informed learning. This function
returns the <a class="reference internal" href="../equations.html#pina.equation.equation.Equation" title="pina.equation.equation.Equation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Equation</span></code></a> specified in the
<a class="reference internal" href="../condition.html#pina.condition.Condition" title="pina.condition.Condition"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Condition</span></code></a> evaluated at the <code class="docutils literal notranslate"><span class="pre">samples</span></code> points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor"><em>LabelTensor</em></a>) – The samples to evaluate the physics loss.</p></li>
<li><p><strong>equation</strong> (<a class="reference internal" href="../equations.html#pina.equation.equation_interface.EquationInterface" title="pina.equation.equation_interface.EquationInterface"><em>EquationInterface</em></a>) – The governing equation
representing the physics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The residual of the neural network solution.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../label_tensor.html#pina.label_tensor.LabelTensor" title="pina.label_tensor.LabelTensor">LabelTensor</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pina.solvers.pinns.basepinn.PINNInterface.store_log">
<code class="sig-name descname">store_log</code><span class="sig-paren">(</span><em class="sig-param">loss_value</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/solvers/pinns/basepinn.html#PINNInterface.store_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.solvers.pinns.basepinn.PINNInterface.store_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the loss value in the logger. This function should be
called for all conditions. It automatically handles the storing
conditions names. It must be used
anytime a specific variable wants to be stored for a specific condition.
A simple example is to use the variable to store the residual.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The name of the loss.</p></li>
<li><p><strong>loss_value</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.3)"><em>torch.Tensor</em></a>) – The value of the loss.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pina.solvers.pinns.basepinn.PINNInterface.on_train_epoch_end">
<code class="sig-name descname">on_train_epoch_end</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pina/solvers/pinns/basepinn.html#PINNInterface.on_train_epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pina.solvers.pinns.basepinn.PINNInterface.on_train_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>At the end of each epoch we free the stored losses. This function
should not be override if not intentionally.</p>
</dd></dl>

<dl class="method">
<dt id="pina.solvers.pinns.basepinn.PINNInterface.loss">
<em class="property">property </em><code class="sig-name descname">loss</code><a class="headerlink" href="#pina.solvers.pinns.basepinn.PINNInterface.loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss used for training.</p>
</dd></dl>

<dl class="method">
<dt id="pina.solvers.pinns.basepinn.PINNInterface.current_condition_name">
<em class="property">property </em><code class="sig-name descname">current_condition_name</code><a class="headerlink" href="#pina.solvers.pinns.basepinn.PINNInterface.current_condition_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the condition name. This function can be used inside the
<a class="reference internal" href="#pina.solvers.pinns.basepinn.PINNInterface.loss_phys" title="pina.solvers.pinns.basepinn.PINNInterface.loss_phys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">loss_phys()</span></code></a> to extract the condition at which the loss is
computed.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="solver_interface.html" class="btn btn-neutral float-left" title="SolverInterface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pinn.html" class="btn btn-neutral float-right" title="PINN" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2024, PINA Contributors.
      <span class="lastupdated">Last updated on Jul 01, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>