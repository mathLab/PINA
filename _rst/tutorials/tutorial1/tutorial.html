
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial: Physics Informed Neural Networks on PINA &#8212; PINA 0.1.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=92734c54"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_rst/tutorials/tutorial1/tutorial';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Tutorial: The Equation Class" href="../tutorial12/tutorial.html" />
    <link rel="prev" title="PINA Tutorials" href="../../_tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Oct 01, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/PINA_logo.png" class="logo__image only-light" alt="PINA 0.1.2 documentation - Home"/>
    <script>document.write(`<img src="../../../_static/PINA_logo.png" class="logo__image only-dark" alt="PINA 0.1.2 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../_tutorial.html">
    Tutorial
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_code.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_team.html">
    Team & Foundings
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_LICENSE.html">
    License
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_cite.html">
    Cite PINA
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mathLab/PINA" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/pina_mathlab?s=21" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="mailto:pina.mathlab@gmail.com" title="Email" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Email</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../_tutorial.html">
    Tutorial
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_code.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_team.html">
    Team & Foundings
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_LICENSE.html">
    License
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_cite.html">
    Cite PINA
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mathLab/PINA" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/pina_mathlab?s=21" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="mailto:pina.mathlab@gmail.com" title="Email" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Email</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Introduction to PINA for Physics Informed Neural Networks training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial12/tutorial.html">Introduction to PINA Equation class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial11/tutorial.html">PINA and PyTorch Lightning, training tips and visualizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial6/tutorial.html">Building custom geometries with PINA Location class</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial2/tutorial.html">Two dimensional Poisson problem using Extra Features Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial3/tutorial.html">Two dimensional Wave problem with hard constraint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial7/tutorial.html">Resolution of a 2D Poisson inverse problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial9/tutorial.html">Periodic Boundary Conditions for Helmotz Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial13/tutorial.html">Multiscale PDE learning with Fourier Feature Network</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial5/tutorial.html">Two dimensional Darcy flow using the Fourier Neural Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial10/tutorial.html">Time dependent Kuramoto Sivashinsky equation using the Averaging Neural Operator</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial4/tutorial.html">Unstructured convolutional autoencoder via continuous convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial8/tutorial.html">POD-RBF and POD-NN for reduced order modeling</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../_tutorial.html" class="nav-link">PINA Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Tutorial:...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tutorial-physics-informed-neural-networks-on-pina">
<h1>Tutorial: Physics Informed Neural Networks on PINA<a class="headerlink" href="#tutorial-physics-informed-neural-networks-on-pina" title="Link to this heading">#</a></h1>
<p>In this tutorial, we will demonstrate a typical use case of <strong>PINA</strong> on
a toy problem, following the standard API procedure.</p>
<p align="center"></p><p>Specifically, the tutorial aims to introduce the following topics:</p>
<ul class="simple">
<li><p>Explaining how to build <strong>PINA</strong> Problems,</p></li>
<li><p>Showing how to generate data for <code class="docutils literal notranslate"><span class="pre">PINN</span></code> training</p></li>
</ul>
<p>These are the two main steps needed <strong>before</strong> starting the modelling
optimization (choose model and solver, and train). We will show each
step in detail, and at the end, we will solve a simple Ordinary
Differential Equation (ODE) problem using the <code class="docutils literal notranslate"><span class="pre">PINN</span></code> solver.</p>
<section id="build-a-pina-problem">
<h2>Build a PINA problem<a class="headerlink" href="#build-a-pina-problem" title="Link to this heading">#</a></h2>
<p>Problem definition in the <strong>PINA</strong> framework is done by building a
python <code class="docutils literal notranslate"><span class="pre">class</span></code>, which inherits from one or more problem classes
(<code class="docutils literal notranslate"><span class="pre">SpatialProblem</span></code>, <code class="docutils literal notranslate"><span class="pre">TimeDependentProblem</span></code>, <code class="docutils literal notranslate"><span class="pre">ParametricProblem</span></code>, …)
depending on the nature of the problem. Below is an example:</p>
<section id="simple-ordinary-differential-equation">
<h3>Simple Ordinary Differential Equation<a class="headerlink" href="#simple-ordinary-differential-equation" title="Link to this heading">#</a></h3>
<p>Consider the following:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\begin{cases}
\frac{d}{dx}u(x) &amp;=  u(x) \quad x\in(0,1)\\
u(x=0) &amp;= 1 \\
\end{cases}
\end{equation}\end{split}\]</div>
<p>with the analytical solution <span class="math notranslate nohighlight">\(u(x) = e^x\)</span>. In this case, our ODE
depends only on the spatial variable <span class="math notranslate nohighlight">\(x\in(0,1)\)</span> , meaning that
our <code class="docutils literal notranslate"><span class="pre">Problem</span></code> class is going to be inherited from the
<code class="docutils literal notranslate"><span class="pre">SpatialProblem</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pina.problem</span> <span class="kn">import</span> <span class="n">SpatialProblem</span>
<span class="kn">from</span> <span class="nn">pina.geometry</span> <span class="kn">import</span> <span class="n">CartesianProblem</span>

<span class="k">class</span> <span class="nc">SimpleODE</span><span class="p">(</span><span class="n">SpatialProblem</span><span class="p">):</span>

    <span class="n">output_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;u&#39;</span><span class="p">]</span>
    <span class="n">spatial_domain</span> <span class="o">=</span> <span class="n">CartesianProblem</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>

    <span class="c1"># other stuff ...</span>
</pre></div>
</div>
<p>Notice that we define <code class="docutils literal notranslate"><span class="pre">output_variables</span></code> as a list of symbols,
indicating the output variables of our equation (in this case only
<span class="math notranslate nohighlight">\(u\)</span>), this is done because in <strong>PINA</strong> the <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>s are
labelled, allowing the user maximal flexibility for the manipulation of
the tensor. The <code class="docutils literal notranslate"><span class="pre">spatial_domain</span></code> variable indicates where the sample
points are going to be sampled in the domain, in this case
<span class="math notranslate nohighlight">\(x\in[0,1]\)</span>.</p>
<p>What if our equation is also time-dependent? In this case, our <code class="docutils literal notranslate"><span class="pre">class</span></code>
will inherit from both <code class="docutils literal notranslate"><span class="pre">SpatialProblem</span></code> and <code class="docutils literal notranslate"><span class="pre">TimeDependentProblem</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from pina.problem import SpatialProblem, TimeDependentProblem
from pina.geometry import CartesianDomain

class TimeSpaceODE(SpatialProblem, TimeDependentProblem):

    output_variables = [&#39;u&#39;]
    spatial_domain = CartesianDomain({&#39;x&#39;: [0, 1]})
    temporal_domain = CartesianDomain({&#39;t&#39;: [0, 1]})

    # other stuff ...
</pre></div>
</div>
<p>where we have included the <code class="docutils literal notranslate"><span class="pre">temporal_domain</span></code> variable, indicating the
time domain wanted for the solution.</p>
<p>In summary, using <strong>PINA</strong>, we can initialize a problem with a class
which inherits from different base classes: <code class="docutils literal notranslate"><span class="pre">SpatialProblem</span></code>,
<code class="docutils literal notranslate"><span class="pre">TimeDependentProblem</span></code>, <code class="docutils literal notranslate"><span class="pre">ParametricProblem</span></code>, and so on depending on
the type of problem we are considering. Here are some examples (more on
the official documentation):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SpatialProblem</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> a differential equation with spatial variable(s) <code class="docutils literal notranslate"><span class="pre">spatial_domain</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TimeDependentProblem</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> a time-dependent differential equation with temporal variable(s) <code class="docutils literal notranslate"><span class="pre">temporal_domain</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ParametricProblem</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> a parametrized differential equation with parametric variable(s) <code class="docutils literal notranslate"><span class="pre">parameter_domain</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AbstractProblem</span></code> <span class="math notranslate nohighlight">\(\rightarrow\)</span> any <strong>PINA</strong> problem inherits from here</p></li>
</ul>
</section>
<section id="write-the-problem-class">
<h3>Write the problem class<a class="headerlink" href="#write-the-problem-class" title="Link to this heading">#</a></h3>
<p>Once the <code class="docutils literal notranslate"><span class="pre">Problem</span></code> class is initialized, we need to represent the
differential equation in <strong>PINA</strong>. In order to do this, we need to load
the <strong>PINA</strong> operators from <code class="docutils literal notranslate"><span class="pre">pina.operators</span></code> module. Again, we’ll
consider Equation (1) and represent it in <strong>PINA</strong>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from pina.problem import SpatialProblem
from pina.operators import grad
from pina import Condition
from pina.geometry import CartesianDomain
from pina.equation import Equation, FixedValue

import torch


class SimpleODE(SpatialProblem):

    output_variables = [&#39;u&#39;]
    spatial_domain = CartesianDomain({&#39;x&#39;: [0, 1]})

    # defining the ode equation
    def ode_equation(input_, output_):

        # computing the derivative
        u_x = grad(output_, input_, components=[&#39;u&#39;], d=[&#39;x&#39;])

        # extracting the u input variable
        u = output_.extract([&#39;u&#39;])

        # calculate the residual and return it
        return u_x - u

    # conditions to hold
    conditions = {
        &#39;x0&#39;: Condition(location=CartesianDomain({&#39;x&#39;: 0.}), equation=FixedValue(1)),             # We fix initial condition to value 1
        &#39;D&#39;: Condition(location=CartesianDomain({&#39;x&#39;: [0, 1]}), equation=Equation(ode_equation)), # We wrap the python equation using Equation
    }

    # sampled points (see below)
    input_pts = None

    # defining the true solution
    def truth_solution(self, pts):
        return torch.exp(pts.extract([&#39;x&#39;]))

problem = SimpleODE()
</pre></div>
</div>
<p>After we define the <code class="docutils literal notranslate"><span class="pre">Problem</span></code> class, we need to write different class
methods, where each method is a function returning a residual. These
functions are the ones minimized during PINN optimization, given the
initial conditions. For example, in the domain <span class="math notranslate nohighlight">\([0,1]\)</span>, the ODE
equation (<code class="docutils literal notranslate"><span class="pre">ode_equation</span></code>) must be satisfied. We represent this by
returning the difference between subtracting the variable <code class="docutils literal notranslate"><span class="pre">u</span></code> from its
gradient (the residual), which we hope to minimize to 0. This is done
for all conditions. Notice that we do not pass directly a <code class="docutils literal notranslate"><span class="pre">python</span></code>
function, but an <code class="docutils literal notranslate"><span class="pre">Equation</span></code> object, which is initialized with the
<code class="docutils literal notranslate"><span class="pre">python</span></code> function. This is done so that all the computations and
internal checks are done inside <strong>PINA</strong>.</p>
<p>Once we have defined the function, we need to tell the neural network
where these methods are to be applied. To do so, we use the
<code class="docutils literal notranslate"><span class="pre">Condition</span></code> class. In the <code class="docutils literal notranslate"><span class="pre">Condition</span></code> class, we pass the location
points and the equation we want minimized on those points (other
possibilities are allowed, see the documentation for reference).</p>
<p>Finally, it’s possible to define a <code class="docutils literal notranslate"><span class="pre">truth_solution</span></code> function, which
can be useful if we want to plot the results and see how the real
solution compares to the expected (true) solution. Notice that the
<code class="docutils literal notranslate"><span class="pre">truth_solution</span></code> function is a method of the <code class="docutils literal notranslate"><span class="pre">PINN</span></code> class, but it is
not mandatory for problem definition.</p>
</section>
</section>
<section id="generate-data">
<h2>Generate data<a class="headerlink" href="#generate-data" title="Link to this heading">#</a></h2>
<p>Data for training can come in form of direct numerical simulation
results, or points in the domains. In case we perform unsupervised
learning, we just need the collocation points for training, i.e. points
where we want to evaluate the neural network. Sampling point in <strong>PINA</strong>
is very easy, here we show three examples using the
<code class="docutils literal notranslate"><span class="pre">.discretise_domain</span></code> method of the <code class="docutils literal notranslate"><span class="pre">AbstractProblem</span></code> class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># sampling 20 points in [0, 1] through discretization in all locations
problem.discretise_domain(n=20, mode=&#39;grid&#39;, variables=[&#39;x&#39;], locations=&#39;all&#39;)

# sampling 20 points in (0, 1) through latin hypercube sampling in D, and 1 point in x0
problem.discretise_domain(n=20, mode=&#39;latin&#39;, variables=[&#39;x&#39;], locations=[&#39;D&#39;])
problem.discretise_domain(n=1, mode=&#39;random&#39;, variables=[&#39;x&#39;], locations=[&#39;x0&#39;])

# sampling 20 points in (0, 1) randomly
problem.discretise_domain(n=20, mode=&#39;random&#39;, variables=[&#39;x&#39;])
</pre></div>
</div>
<p>We are going to use latin hypercube points for sampling. We need to
sample in all the conditions domains. In our case we sample in <code class="docutils literal notranslate"><span class="pre">D</span></code> and
<code class="docutils literal notranslate"><span class="pre">x0</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># sampling for training
problem.discretise_domain(1, &#39;random&#39;, locations=[&#39;x0&#39;])
problem.discretise_domain(20, &#39;lh&#39;, locations=[&#39;D&#39;])
</pre></div>
</div>
<p>The points are saved in a python <code class="docutils literal notranslate"><span class="pre">dict</span></code>, and can be accessed by
calling the attribute <code class="docutils literal notranslate"><span class="pre">input_pts</span></code> of the problem</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(&#39;Input points:&#39;, problem.input_pts)
print(&#39;Input points labels:&#39;, problem.input_pts[&#39;D&#39;].labels)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Input</span> <span class="n">points</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x0&#39;</span><span class="p">:</span> <span class="n">LabelTensor</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">]]]),</span> <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="n">LabelTensor</span><span class="p">([[[</span><span class="mf">0.7644</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.2028</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.1789</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.4294</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.3239</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.6531</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.1406</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.6062</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.4969</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.7429</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.8681</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.3800</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.5357</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.0152</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.9679</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.8101</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.0662</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.9095</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.2503</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.5580</span><span class="p">]]])}</span>
<span class="n">Input</span> <span class="n">points</span> <span class="n">labels</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>To visualize the sampled points we can use the <code class="docutils literal notranslate"><span class="pre">.plot_samples</span></code> method
of the <code class="docutils literal notranslate"><span class="pre">Plotter</span></code> class</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from pina import Plotter

pl = Plotter()
pl.plot_samples(problem=problem)
</pre></div>
</div>
<img alt="../../../_images/tutorial_16_0.png" src="../../../_images/tutorial_16_0.png" />
</section>
<section id="perform-a-small-training">
<h2>Perform a small training<a class="headerlink" href="#perform-a-small-training" title="Link to this heading">#</a></h2>
<p>Once we have defined the problem and generated the data we can start the
modelling. Here we will choose a <code class="docutils literal notranslate"><span class="pre">FeedForward</span></code> neural network
available in <code class="docutils literal notranslate"><span class="pre">pina.model</span></code>, and we will train using the <code class="docutils literal notranslate"><span class="pre">PINN</span></code> solver
from <code class="docutils literal notranslate"><span class="pre">pina.solvers</span></code>. We highlight that this training is fairly simple,
for more advanced stuff consider the tutorials in the <strong>Physics Informed
Neural Networks</strong> section of <strong>Tutorials</strong>. For training we use the
<code class="docutils literal notranslate"><span class="pre">Trainer</span></code> class from <code class="docutils literal notranslate"><span class="pre">pina.trainer</span></code>. Here we show a very short
training and some method for plotting the results. Notice that by
default all relevant metrics (e.g. MSE error during training) are going
to be tracked using a <code class="docutils literal notranslate"><span class="pre">lightining</span></code> logger, by default <code class="docutils literal notranslate"><span class="pre">CSVLogger</span></code>.
If you want to track the metric by yourself without a logger, use
<code class="docutils literal notranslate"><span class="pre">pina.callbacks.MetricTracker</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from pina import Trainer
from pina.solvers import PINN
from pina.model import FeedForward
from pina.callbacks import MetricTracker


# build the model
model = FeedForward(
    layers=[10, 10],
    func=torch.nn.Tanh,
    output_dimensions=len(problem.output_variables),
    input_dimensions=len(problem.input_variables)
)

# create the PINN object
pinn = PINN(problem, model)

# create the trainer
trainer = Trainer(solver=pinn, max_epochs=1500, callbacks=[MetricTracker()], accelerator=&#39;cpu&#39;, enable_model_summary=False) # we train on CPU and avoid model summary at beginning of training (optional)

# train
trainer.train()
</pre></div>
</div>
<p>After the training we can inspect trainer logged metrics (by default
<strong>PINA</strong> logs mean square error residual loss). The logged metrics can
be accessed online using one of the <code class="docutils literal notranslate"><span class="pre">Lightinig</span></code> loggers. The final
loss can be accessed by <code class="docutils literal notranslate"><span class="pre">trainer.logged_metrics</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># inspecting final loss
trainer.logged_metrics
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;x0_loss&#39;</span><span class="p">:</span> <span class="n">tensor</span><span class="p">(</span><span class="mf">1.0674e-05</span><span class="p">),</span>
 <span class="s1">&#39;D_loss&#39;</span><span class="p">:</span> <span class="n">tensor</span><span class="p">(</span><span class="mf">0.0008</span><span class="p">),</span>
 <span class="s1">&#39;mean_loss&#39;</span><span class="p">:</span> <span class="n">tensor</span><span class="p">(</span><span class="mf">0.0004</span><span class="p">)}</span>
</pre></div>
</div>
<p>By using the <code class="docutils literal notranslate"><span class="pre">Plotter</span></code> class from <strong>PINA</strong> we can also do some
quatitative plots of the solution.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># plotting the solution
pl.plot(solver=pinn)
</pre></div>
</div>
<img alt="../../../_images/tutorial_23_1.png" src="../../../_images/tutorial_23_1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">Figure</span> <span class="n">size</span> <span class="mi">640</span><span class="n">x480</span> <span class="k">with</span> <span class="mi">0</span> <span class="n">Axes</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The solution is overlapped with the actual one, and they are barely
indistinguishable. We can also plot easily the loss:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pl.plot_loss(trainer=trainer, label = &#39;mean_loss&#39;, logy=True)
</pre></div>
</div>
<img alt="../../../_images/tutorial_25_0.png" src="../../../_images/tutorial_25_0.png" />
<p>As we can see the loss has not reached a minimum, suggesting that we
could train for longer</p>
</section>
<section id="whats-next">
<h2>What’s next?<a class="headerlink" href="#whats-next" title="Link to this heading">#</a></h2>
<p>Congratulations on completing the introductory tutorial of <strong>PINA</strong>!
There are several directions you can go now:</p>
<ol class="arabic simple">
<li><p>Train the network for longer or with different layer sizes and assert
the finaly accuracy</p></li>
<li><p>Train the network using other types of models (see <code class="docutils literal notranslate"><span class="pre">pina.model</span></code>)</p></li>
<li><p>GPU training and speed benchmarking</p></li>
<li><p>Many more…</p></li>
</ol>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-a-pina-problem">Build a PINA problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-ordinary-differential-equation">Simple Ordinary Differential Equation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-the-problem-class">Write the problem class</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-data">Generate data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-a-small-training">Perform a small training</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whats-next">What’s next?</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../_sources/_rst/tutorials/tutorial1/tutorial.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2021-2024, PINA Contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>