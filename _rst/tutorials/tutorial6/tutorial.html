
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial: Building custom geometries with PINA Location class &#8212; PINA 0.1.2.post2501 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="/css/custom.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=ad75e52c"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_rst/tutorials/tutorial6/tutorial';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Tutorial: Two dimensional Poisson problem using Extra Features Learning" href="../tutorial2/tutorial.html" />
    <link rel="prev" title="Tutorial: PINA and PyTorch Lightning, training tips and visualizations" href="../tutorial11/tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.1.2.post2501" />
    <meta name="docbuild:last-update" content="Jan 01, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/PINA_logo.png" class="logo__image only-light" alt="PINA 0.1.2.post2501 documentation - Home"/>
    <img src="../../../_static/PINA_logo.png" class="logo__image only-dark pst-js-only" alt="PINA 0.1.2.post2501 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../_tutorial.html">
    Tutorial
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_code.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_team.html">
    Team & Foundings
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_LICENSE.html">
    License
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_cite.html">
    Cite PINA
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mathLab/PINA" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/pina_mathlab?s=21" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="mailto:pina.mathlab@gmail.com" title="Email" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Email</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_installation.html">
    Installing
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../_tutorial.html">
    Tutorial
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_code.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_team.html">
    Team & Foundings
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../_contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_LICENSE.html">
    License
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../_cite.html">
    Cite PINA
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mathLab/PINA" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/pina_mathlab?s=21" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="mailto:pina.mathlab@gmail.com" title="Email" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Email</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial1/tutorial.html">Introduction to PINA for Physics Informed Neural Networks training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial12/tutorial.html">Introduction to PINA Equation class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial11/tutorial.html">PINA and PyTorch Lightning, training tips and visualizations</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Building custom geometries with PINA Location class</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial2/tutorial.html">Two dimensional Poisson problem using Extra Features Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial3/tutorial.html">Two dimensional Wave problem with hard constraint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial7/tutorial.html">Resolution of a 2D Poisson inverse problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial9/tutorial.html">Periodic Boundary Conditions for Helmotz Equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial13/tutorial.html">Multiscale PDE learning with Fourier Feature Network</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial5/tutorial.html">Two dimensional Darcy flow using the Fourier Neural Operator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial10/tutorial.html">Time dependent Kuramoto Sivashinsky equation using the Averaging Neural Operator</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorial4/tutorial.html">Unstructured convolutional autoencoder via continuous convolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial8/tutorial.html">POD-RBF and POD-NN for reduced order modeling</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../_tutorial.html" class="nav-link">PINA Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Tutorial: Building custom geometries with PINA <code class="docutils literal notranslate"><span class="pre">Location</span></code> class</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tutorial-building-custom-geometries-with-pina-location-class">
<h1>Tutorial: Building custom geometries with PINA <code class="docutils literal notranslate"><span class="pre">Location</span></code> class<a class="headerlink" href="#tutorial-building-custom-geometries-with-pina-location-class" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/mathLab/PINA/blob/master/tutorials/tutorial6/tutorial.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p>In this tutorial we will show how to use geometries in PINA.
Specifically, the tutorial will include how to create geometries and how
to visualize them. The topics covered are:</p>
<ul class="simple">
<li><p>Creating CartesianDomains and EllipsoidDomains</p></li>
<li><p>Getting the Union and Difference of Geometries</p></li>
<li><p>Sampling points in the domain (and visualize them)</p></li>
</ul>
<p>We import the relevant modules first.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>## routine needed to run the notebook on Google Colab
try:
  import google.colab
  IN_COLAB = True
except:
  IN_COLAB = False
if IN_COLAB:
  !pip install &quot;pina-mathlab&quot;

import matplotlib.pyplot as plt
plt.style.use(&#39;tableau-colorblind10&#39;)
from pina.geometry import EllipsoidDomain, Difference, CartesianDomain, Union, SimplexDomain
from pina.label_tensor import LabelTensor

def plot_scatter(ax, pts, title):
    ax.title.set_text(title)
    ax.scatter(pts.extract(&#39;x&#39;), pts.extract(&#39;y&#39;), color=&#39;blue&#39;, alpha=0.5)
</pre></div>
</div>
<section id="built-in-geometries">
<h2>Built-in Geometries<a class="headerlink" href="#built-in-geometries" title="Link to this heading">#</a></h2>
<p>We will create one cartesian and two ellipsoids. For the sake of
simplicity, we show here the 2-dimensional, but it’s trivial the
extension to 3D (and higher) cases. The geometries allows also the
generation of samples belonging to the boundary. So, we will create one
ellipsoid with the border and one without.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cartesian = CartesianDomain({&#39;x&#39;: [0, 2], &#39;y&#39;: [0, 2]})
ellipsoid_no_border = EllipsoidDomain({&#39;x&#39;: [1, 3], &#39;y&#39;: [1, 3]})
ellipsoid_border = EllipsoidDomain({&#39;x&#39;: [2, 4], &#39;y&#39;: [2, 4]}, sample_surface=True)
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">{'x':</span> <span class="pre">[0,</span> <span class="pre">2],</span> <span class="pre">'y':</span> <span class="pre">[0,</span> <span class="pre">2]}</span></code> are the bounds of the
<code class="docutils literal notranslate"><span class="pre">CartesianDomain</span></code> being created.</p>
<p>To visualize these shapes, we need to sample points on them. We will use
the <code class="docutils literal notranslate"><span class="pre">sample</span></code> method of the <code class="docutils literal notranslate"><span class="pre">CartesianDomain</span></code> and <code class="docutils literal notranslate"><span class="pre">EllipsoidDomain</span></code>
classes. This method takes a <code class="docutils literal notranslate"><span class="pre">n</span></code> argument which is the number of
points to sample. It also takes different modes to sample such as
random.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cartesian_samples = cartesian.sample(n=1000, mode=&#39;random&#39;)
ellipsoid_no_border_samples = ellipsoid_no_border.sample(n=1000, mode=&#39;random&#39;)
ellipsoid_border_samples = ellipsoid_border.sample(n=1000, mode=&#39;random&#39;)
</pre></div>
</div>
<p>We can see the samples of each of the geometries to see what we are
working with.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(f&quot;Cartesian Samples: {cartesian_samples}&quot;)
print(f&quot;Ellipsoid No Border Samples: {ellipsoid_no_border_samples}&quot;)
print(f&quot;Ellipsoid Border Samples: {ellipsoid_border_samples}&quot;)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cartesian</span> <span class="n">Samples</span><span class="p">:</span> <span class="n">labels</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">LabelTensor</span><span class="p">([[[</span><span class="mf">0.2300</span><span class="p">,</span> <span class="mf">1.6698</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">1.7785</span><span class="p">,</span> <span class="mf">0.4063</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">1.5143</span><span class="p">,</span> <span class="mf">1.8979</span><span class="p">]],</span>
             <span class="o">...</span><span class="p">,</span>
             <span class="p">[[</span><span class="mf">0.0905</span><span class="p">,</span> <span class="mf">1.4660</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.8176</span><span class="p">,</span> <span class="mf">1.7357</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">0.0475</span><span class="p">,</span> <span class="mf">0.0170</span><span class="p">]]])</span>
<span class="n">Ellipsoid</span> <span class="n">No</span> <span class="n">Border</span> <span class="n">Samples</span><span class="p">:</span> <span class="n">labels</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">LabelTensor</span><span class="p">([[[</span><span class="mf">1.9341</span><span class="p">,</span> <span class="mf">2.0182</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">1.5503</span><span class="p">,</span> <span class="mf">1.8426</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">2.0392</span><span class="p">,</span> <span class="mf">1.7597</span><span class="p">]],</span>
             <span class="o">...</span><span class="p">,</span>
             <span class="p">[[</span><span class="mf">1.8976</span><span class="p">,</span> <span class="mf">2.2859</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">1.8015</span><span class="p">,</span> <span class="mf">2.0012</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">2.2713</span><span class="p">,</span> <span class="mf">2.2355</span><span class="p">]]])</span>
<span class="n">Ellipsoid</span> <span class="n">Border</span> <span class="n">Samples</span><span class="p">:</span> <span class="n">labels</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">LabelTensor</span><span class="p">([[[</span><span class="mf">3.3413</span><span class="p">,</span> <span class="mf">3.9400</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">3.9573</span><span class="p">,</span> <span class="mf">2.7108</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">3.8341</span><span class="p">,</span> <span class="mf">2.4484</span><span class="p">]],</span>
             <span class="o">...</span><span class="p">,</span>
             <span class="p">[[</span><span class="mf">2.7251</span><span class="p">,</span> <span class="mf">2.0385</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">3.8654</span><span class="p">,</span> <span class="mf">2.4990</span><span class="p">]],</span>
             <span class="p">[[</span><span class="mf">3.2292</span><span class="p">,</span> <span class="mf">3.9734</span><span class="p">]]])</span>
</pre></div>
</div>
<p>Notice how these are all <code class="docutils literal notranslate"><span class="pre">LabelTensor</span></code> objects. You can read more
about these in the
<a class="reference external" href="https://mathlab.github.io/PINA/_rst/label_tensor.html">documentation</a>.
At a very high level, they are tensors where each element in a tensor
has a label that we can access by doing <code class="docutils literal notranslate"><span class="pre">&lt;tensor_name&gt;.labels</span></code>. We can
also access the values of the tensor by doing
<code class="docutils literal notranslate"><span class="pre">&lt;tensor_name&gt;.extract(['x'])</span></code>.</p>
<p>We are now ready to visualize the samples using matplotlib.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, axs = plt.subplots(1, 3, figsize=(16, 4))
pts_list = [cartesian_samples, ellipsoid_no_border_samples, ellipsoid_border_samples]
title_list = [&#39;Cartesian Domain&#39;, &#39;Ellipsoid Domain&#39;, &#39;Ellipsoid Border Domain&#39;]
for ax, pts, title in zip(axs, pts_list, title_list):
    plot_scatter(ax, pts, title)
</pre></div>
</div>
<img alt="../../../_images/tutorial_10_0.png" src="../../../_images/tutorial_10_0.png" />
<p>We have now created, sampled, and visualized our first geometries! We
can see that the <code class="docutils literal notranslate"><span class="pre">EllipsoidDomain</span></code> with the border has a border around
it. We can also see that the <code class="docutils literal notranslate"><span class="pre">EllipsoidDomain</span></code> without the border is
just the ellipse. We can also see that the <code class="docutils literal notranslate"><span class="pre">CartesianDomain</span></code> is just a
square.</p>
<section id="simplex-domain">
<h3>Simplex Domain<a class="headerlink" href="#simplex-domain" title="Link to this heading">#</a></h3>
<p>Among the built-in shapes, we quickly show here the usage of
<code class="docutils literal notranslate"><span class="pre">SimplexDomain</span></code>, which can be used for polygonal domains!</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import torch
spatial_domain = SimplexDomain(
                    [
                        LabelTensor(torch.tensor([[0, 0]]), labels=[&quot;x&quot;, &quot;y&quot;]),
                        LabelTensor(torch.tensor([[1, 1]]), labels=[&quot;x&quot;, &quot;y&quot;]),
                        LabelTensor(torch.tensor([[0, 2]]), labels=[&quot;x&quot;, &quot;y&quot;]),
                    ]
                )

spatial_domain2 = SimplexDomain(
                    [
                        LabelTensor(torch.tensor([[ 0., -2.]]), labels=[&quot;x&quot;, &quot;y&quot;]),
                        LabelTensor(torch.tensor([[-.5, -.5]]), labels=[&quot;x&quot;, &quot;y&quot;]),
                        LabelTensor(torch.tensor([[-2.,  0.]]), labels=[&quot;x&quot;, &quot;y&quot;]),
                    ]
                )

pts = spatial_domain2.sample(100)
fig, axs = plt.subplots(1, 2, figsize=(16, 6))
for domain, ax in zip([spatial_domain, spatial_domain2], axs):
    pts = domain.sample(1000)
    plot_scatter(ax, pts, &#39;Simplex Domain&#39;)
</pre></div>
</div>
<img alt="../../../_images/tutorial_13_0.png" src="../../../_images/tutorial_13_0.png" />
</section>
</section>
<section id="boolean-operations">
<h2>Boolean Operations<a class="headerlink" href="#boolean-operations" title="Link to this heading">#</a></h2>
<p>To create complex shapes we can use the boolean operations, for example
to merge two default geometries. We need to simply use the <code class="docutils literal notranslate"><span class="pre">Union</span></code>
class: it takes a list of geometries and returns the union of them.</p>
<p>Let’s create three unions. Firstly, it will be a union of <code class="docutils literal notranslate"><span class="pre">cartesian</span></code>
and <code class="docutils literal notranslate"><span class="pre">ellipsoid_no_border</span></code>. Next, it will be a union of
<code class="docutils literal notranslate"><span class="pre">ellipse_no_border</span></code> and <code class="docutils literal notranslate"><span class="pre">ellipse_border</span></code>. Lastly, it will be a union
of all three geometries.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cart_ellipse_nb_union = Union([cartesian, ellipsoid_no_border])
cart_ellipse_b_union = Union([cartesian, ellipsoid_border])
three_domain_union = Union([cartesian, ellipsoid_no_border, ellipsoid_border])
</pre></div>
</div>
<p>We can of course sample points over the new geometries, by using the
<code class="docutils literal notranslate"><span class="pre">sample</span></code> method as before. We highlihgt that the available sample
strategy here is only <em>random</em>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>c_e_nb_u_points = cart_ellipse_nb_union.sample(n=2000, mode=&#39;random&#39;)
c_e_b_u_points = cart_ellipse_b_union.sample(n=2000, mode=&#39;random&#39;)
three_domain_union_points = three_domain_union.sample(n=3000, mode=&#39;random&#39;)
</pre></div>
</div>
<p>We can plot the samples of each of the unions to see what we are working
with.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>fig, axs = plt.subplots(1, 3, figsize=(16, 4))
pts_list = [c_e_nb_u_points, c_e_b_u_points, three_domain_union_points]
title_list = [&#39;Cartesian with Ellipsoid No Border Union&#39;, &#39;Cartesian with Ellipsoid Border Union&#39;, &#39;Three Domain Union&#39;]
for ax, pts, title in zip(axs, pts_list, title_list):
    plot_scatter(ax, pts, title)
</pre></div>
</div>
<img alt="../../../_images/tutorial_20_0.png" src="../../../_images/tutorial_20_0.png" />
<p>Now, we will find the differences of the geometries. We will find the
difference of <code class="docutils literal notranslate"><span class="pre">cartesian</span></code> and <code class="docutils literal notranslate"><span class="pre">ellipsoid_no_border</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>cart_ellipse_nb_difference = Difference([cartesian, ellipsoid_no_border])
c_e_nb_d_points = cart_ellipse_nb_difference.sample(n=2000, mode=&#39;random&#39;)

fig, ax = plt.subplots(1, 1, figsize=(8, 6))
plot_scatter(ax, c_e_nb_d_points, &#39;Difference&#39;)
</pre></div>
</div>
<img alt="../../../_images/tutorial_22_0.png" src="../../../_images/tutorial_22_0.png" />
</section>
<section id="create-custom-location">
<h2>Create Custom Location<a class="headerlink" href="#create-custom-location" title="Link to this heading">#</a></h2>
<p>We will take a look on how to create our own geometry. The one we will
try to make is a heart defined by the function</p>
<div class="math notranslate nohighlight">
\[(x^2+y^2-1)^3-x^2y^3 \le 0\]</div>
<p>Let’s start by importing what we will need to create our own geometry
based on this equation.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import torch
from pina import Location
from pina import LabelTensor
import random
</pre></div>
</div>
<p>Next, we will create the <code class="docutils literal notranslate"><span class="pre">Heart(Location)</span></code> class and initialize it.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>class Heart(Location):
    &quot;&quot;&quot;Implementation of the Heart Domain.&quot;&quot;&quot;

    def __init__(self, sample_border=False):
        super().__init__()
</pre></div>
</div>
<p>Because the <code class="docutils literal notranslate"><span class="pre">Location</span></code> class we are inherting from requires both a
<code class="docutils literal notranslate"><span class="pre">sample</span></code> method and <code class="docutils literal notranslate"><span class="pre">is_inside</span></code> method, we will create them and just
add in “pass” for the moment.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>class Heart(Location):
    &quot;&quot;&quot;Implementation of the Heart Domain.&quot;&quot;&quot;

    def __init__(self, sample_border=False):
        super().__init__()

    def is_inside(self):
        pass

    def sample(self):
        pass
</pre></div>
</div>
<p>Now we have the skeleton for our <code class="docutils literal notranslate"><span class="pre">Heart</span></code> class. The <code class="docutils literal notranslate"><span class="pre">sample</span></code>
method is where most of the work is done so let’s fill it out.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>class Heart(Location):
    &quot;&quot;&quot;Implementation of the Heart Domain.&quot;&quot;&quot;

    def __init__(self, sample_border=False):
        super().__init__()

    def is_inside(self):
        pass

    def sample(self, n, mode=&#39;random&#39;, variables=&#39;all&#39;):
        sampled_points = []

        while len(sampled_points) &lt; n:
            x = torch.rand(1)*3.-1.5
            y = torch.rand(1)*3.-1.5
            if ((x**2 + y**2 - 1)**3 - (x**2)*(y**3)) &lt;= 0:
                sampled_points.append([x.item(), y.item()])

        return LabelTensor(torch.tensor(sampled_points), labels=[&#39;x&#39;,&#39;y&#39;])
</pre></div>
</div>
<p>To create the Heart geometry we simply run:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>heart = Heart()
</pre></div>
</div>
<p>To sample from the Heart geometry we simply run:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>pts_heart = heart.sample(1500)

fig, ax = plt.subplots()
plot_scatter(ax, pts_heart, &#39;Heart Domain&#39;)
</pre></div>
</div>
<img alt="../../../_images/tutorial_36_0.png" src="../../../_images/tutorial_36_0.png" />
</section>
<section id="whats-next">
<h2>What’s next?<a class="headerlink" href="#whats-next" title="Link to this heading">#</a></h2>
<p>We have made a very simple tutorial on how to build custom geometries
and use domain operation to compose base geometries. Now you can play
around with different geometries and build your own!</p>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#built-in-geometries">Built-in Geometries</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simplex-domain">Simplex Domain</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boolean-operations">Boolean Operations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-custom-location">Create Custom Location</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whats-next">What’s next?</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/_rst/tutorials/tutorial6/tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2021-2024, PINA Contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>